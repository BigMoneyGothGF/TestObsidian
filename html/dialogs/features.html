<form class="obsidian" autocomplete="off">
	<label class="obsidian-inline obsidian-label-lg">
		{{localize 'OBSIDIAN.CustomFeatures'}}
		<button type="button" class="obsidian-btn-positive obsidian-btn-sm obsidian-add-feature">
			{{localize 'OBSIDIAN.Add'}}
		</button>
	</label>
	{{#each entity.flags.obsidian.features.custom as |feat id|}}
		<input type="hidden" name="flags.obsidian.features.custom.{{id}}.id" value="{{feat.id}}">
		<div class="obsidian-form-row obsidian-mixed-form-row obsidian-inline" data-item-id="{{id}}">
			<div>
				<input type="text" class="obsidian-input-compact"
				       placeholder="{{localize 'OBSIDIAN.Feature'}}" value="{{feat.label}}"
				       name="flags.obsidian.features.custom.{{id}}.label">
				<select name="flags.obsidian.features.custom.{{id}}.active" class="obsidian-feat-active"
				        data-selector="active.{{id}}">
					{{#select feat.active}}
						{{#each ../ObsidianRules.FEAT_ACTIVE}}
							<option value="{{this}}">{{i18n-join 'OBSIDIAN.FeatActive-' this}}</option>
						{{/each}}
					{{/select}}
				</select>
				<select name="flags.obsidian.features.custom.{{id}}.action" data-show="active"
				        class="{{#if (expr '===' 'passive' feat.active)}}obsidian-hidden{{/if}}"
				        data-selector-parent="active.{{id}}">
					{{#select feat.action}}
						{{#each ../ObsidianRules.FEAT_ACTION}}
							<option value="{{this}}">{{i18n-join 'OBSIDIAN.FeatAction-' this}}</option>
						{{/each}}
					{{/select}}
				</select>
			</div>
			<button type="button" class="obsidian-btn-negative obsidian-btn-sm obsidian-rm-feature">
				{{localize 'OBSIDIAN.Remove'}}
			</button>
		</div>
	{{/each}}
</form>
