<form class="obsidian" autocomplete="off">
	<input type="hidden" name="flags.obsidian.custom" data-dtype="Boolean" value="true">
	<fieldset>
		<legend>{{localize 'OBSIDIAN.Attack'}}</legend>
		<div class="obsidian-form-row obsidian-mixed-form-row obsidian-inline">
			<div style="width: 350px;">
				<input class="obsidian-input-compact obsidian-input-lg" type="text"
				       name="name" placeholder="{{localize 'OBSIDIAN.Attack'}}" value="{{attack.name}}">
				<select name="flags.obsidian.type" class="obsidian-attack-type">
					{{#select attack.flags.obsidian.type}}
						{{#each ObsidianRules.ATTACK_TYPES}}
							<option value="{{this}}">{{i18n-join 'OBSIDIAN.AttackType-' this}}</option>
						{{/each}}
					{{/select}}
				</select>
				<label class="obsidian-inline">
					<input type="text" class="obsidian-input-compact obsidian-input-num obsidian-input-num-sm"
					       name="flags.obsidian.magic" placeholder="0" data-dtype="Number"
					       value="{{attack.flags.obsidian.magic}}">
					<span>{{localize 'OBSIDIAN.Magic'}}</span>
				</label>
			</div>
		</div>
		<div class="
			{{#if
				(expr '&&'
					(expr '!' attack.flags.obsidian.tags.thrown)
					(expr '===' attack.flags.obsidian.type 'melee'))~}}
				obsidian-hidden
			{{~/if}} obsidian-form-row obsidian-range-row obsidian-inline obsidian-stacked-row">
			<div>
				<label class="obsidian-inline">
					{{localize 'OBSIDIAN.Range'}}
					<input type="text" name="flags.obsidian.range1"
					       data-dtype="Number" value="{{attack.flags.obsidian.range1}}" placeholder="0"
					       class="obsidian-input-compact obsidian-input-num obsidian-input-num-md">
				</label>
				<span class="obsidian-binary-operator">&sol;</span>
				<input type="text" name="flags.obsidian.range2" placeholder="0"
				       data-dtype="Number" value="{{attack.flags.obsidian.range2}}"
				       class="obsidian-input-compact obsidian-input-num obsidian-input-num-md">
			</div>
		</div>
	</fieldset>
	<fieldset {{disabled (expr '!' attack.flags.obsidian.hit.enabled)}}>
		<legend>
			{{fancy-checkbox 'flags.obsidian.hit.enabled' content='OBSIDIAN.Hit'
			                 checked=attack.flags.obsidian.hit.enabled}}
		</legend>
		<div class="obsidian-form-row obsidian-mixed-form-row obsidian-inline">
			<div class="obsidian-checkbox-row">
				<select name="flags.obsidian.hit.stat">
					{{#select attack.flags.obsidian.hit.stat}}
						{{#each data.abilities}}
							<option value="{{@key}}">{{i18n-join 'OBSIDIAN.Ability-' @key}}</option>
						{{/each}}
					{{/select}}
				</select>
				<span class="obsidian-binary-operator">&plus;</span>
				<input type="text" class="obsidian-input-compact obsidian-input-num obsidian-input-num-sm"
				       data-dtype="Number" name="flags.obsidian.hit.bonus"
				       placeholder="0" value="{{attack.flags.obsidian.hit.bonus}}">
				<label class="obsidian-inline">
					<input type="text" class="obsidian-input-compact obsidian-input-num obsidian-input-num-sm"
					       name="flags.obsidian.hit.crit" placeholder="20"
					       value="{{attack.flags.obsidian.hit.crit}}">
					<span>{{localize 'OBSIDIAN.Crit'}}</span>
				</label>
				{{fancy-checkbox 'flags.obsidian.hit.proficient' content='OBSIDIAN.Proficiency-prof'
				                 checked=attack.flags.obsidian.hit.proficient}}
			</div>
		</div>
	</fieldset>
	{{> public/modules/obsidian/html/components/dc.html attack.flags.obsidian.dc
			abilities=data.abilities ObsidianRules=ObsidianRules}}
	<fieldset data-prop="damage">
		<legend>{{localize 'OBSIDIAN.Damage'}}</legend>
		{{> public/modules/obsidian/html/components/damage.html dmgs=attack.flags.obsidian.damage
				prop='damage'}}
	</fieldset>
	<fieldset class="{{#if (expr '!' attack.flags.obsidian.tags.versatile)}}
		obsidian-hidden
	{{/if}} obsidian-versatile-block" data-prop="versatile">
		<legend>{{localize 'OBSIDIAN.VersatileDamage'}}</legend>
		{{> public/modules/obsidian/html/components/damage.html dmgs=attack.flags.obsidian.versatile
				prop='versatile'}}
	</fieldset>
	<fieldset>
		<legend>{{localize 'OBSIDIAN.Tags'}}</legend>
		{{#each attack.flags.obsidian.tags as |tag|}}
			<div class="obsidian-form-row obsidian-mixed-form-row obsidian-inline">
				<div style="width: 300px;">
					<select class="obsidian-attack-tag">
						{{#select (is-custom-tag @key tag)}}
							{{#each ../ObsidianRules.ATTACK_TAGS}}
								<option value="{{this}}">{{{i18n-join 'OBSIDIAN.AtkTag-' this}}}</option>
							{{/each}}
						{{/select}}
					</select>
					<input type="text" placeholder="{{localize 'OBSIDIAN.Tag'}}"
					       class="{{#if (expr '!' tag.custom)}}obsidian-hidden{{/if}} obsidian-input-compact
					       obsidian-input-lg" value="{{tag.label}}">
				</div>
				<button type="button" class="obsidian-btn-negative obsidian-btn-sm obsidian-rm-tag"
				        data-key="{{@key}}">
					{{localize 'OBSIDIAN.Remove'}}
				</button>
			</div>
		{{/each}}
		<div class="obsidian-form-row obsidian-btn-row" style="justify-content: flex-end;">
			<button type="button" class="obsidian-btn-positive obsidian-btn-sm obsidian-add-tag">
				{{localize 'OBSIDIAN.Add'}}
			</button>
		</div>
	</fieldset>
</form>
