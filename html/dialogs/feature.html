<form class="obsidian" autocomplete="off" data-obsidian-name="feature">
	<input type="hidden" name="flags.obsidian.features.custom.{{featureID}}.custom" value="true"
	       data-dtype="Boolean">
	<fieldset>
		<legend>{{localize 'OBSIDIAN.Feature'}}</legend>
		<div class="obsidian-form-row obsidian-mixed-form-row obsidian-inline">
			<div style="width: 380px;">
				<input class="obsidian-input-compact obsidian-input-lg" type="text"
				       value="{{feature.label}}" placeholder="{{localize 'OBSIDIAN.Feature'}}"
				       name="flags.obsidian.features.custom.{{featureID}}.label">
				<select name="flags.obsidian.features.custom.{{featureID}}.active" data-selector="active">
					{{#select feature.active}}
						{{#each ObsidianRules.FEAT_ACTIVE}}
							<option value="{{this}}">{{localize (expr '+' 'OBSIDIAN.FeatActive-' this)}}</option>
						{{/each}}
					{{/select}}
				</select>
				<select name="flags.obsidian.features.custom.{{featureID}}.action" data-hide="passive"
				        data-selector-parent="active">
					{{#select feature.action}}
						{{#each ObsidianRules.FEAT_ACTION}}
							<option value="{{this}}">{{localize (expr '+' 'OBSIDIAN.FeatAction-' this)}}</option>
						{{/each}}
					{{/select}}
				</select>
			</div>
		</div>
		<div class="obsidian-form-row obsidian-mixed-form-row obsidian-stacked-row obsidian-inline">
			<div class="obsidian-checkbox-row">
				<label class="obsidian-inline">
					{{localize 'OBSIDIAN.Source'}}
					<select name="flags.obsidian.features.custom.{{featureID}}.source.type"
					        class="obsidian-feat-source" data-selector="action">
						{{#select feature.source.type}}
							{{#each ObsidianRules.FEAT_SOURCE_TYPES}}
								<option value="{{this}}">{{localize (expr '+' 'OBSIDIAN.FeatSrc-' this)}}</option>
							{{/each}}
						{{/select}}
					</select>
				</label>
				<select name="flags.obsidian.features.custom.{{featureID}}.source.class" data-dtype="Number"
				        data-selector-parent="action" data-show="class">
					{{#select feature.source.class}}
						{{#each entity.flags.obsidian.classes as |class id|}}
							<option value="{{id}}">{{class.label}}</option>
						{{/each}}
					{{/select}}
				</select>
				<select name="flags.obsidian.features.custom.{{featureID}}.source.level" data-dtype="Number"
				        data-selector-parent="action" data-show="feat">
					{{#select feature.source.level}}
						{{#each (range 1 data.details.level.value)}}
							<option value="{{this}}">{{this}}</option>
						{{/each}}
					{{/select}}
				</select>
				<input type="text" name="flags.obsidian.features.custom.{{featureID}}.source.other"
				       placeholder="{{localize 'OBSIDIAN.Source'}}" value="{{feature.source.other}}"
				       class="obsidian-input-compact obsidian-input-lg" data-selector-parent="action"
				       data-show="other">
			</div>
		</div>
	</fieldset>
	<fieldset {{disabled (expr '!' feature.uses.enabled)}}>
		<legend>
			<div class="fancy-checkbox"
			     data-bound="flags.obsidian.features.custom.{{featureID}}.uses.enabled">
				<div class="checkbox-container">
					<div class="checkbox-inner-box"></div>
					<div class="checkmark-container">
						<div class="checkmark">
							<div class="checkmark-short"></div>
							<div class="checkmark-long"></div>
						</div>
					</div>
				</div>
				<div class="checkbox-content">{{localize 'OBSIDIAN.Uses'}}</div>
			</div>
			<input type="checkbox" name="flags.obsidian.features.custom.{{featureID}}.uses.enabled"
			       class="obsidian-hidden" {{checked feature.uses.enabled}}>
		</legend>
		<div class="obsidian-form-row obsidian-mixed-form-row obsidian-inline">
			<div>
				<input type="text" class="obsidian-input-compact obsidian-input-num obsidian-input-num-sm"
				       data-dtype="Number" placeholder="0" value="{{feature.uses.bonus}}"
				       name="flags.obsidian.features.custom.{{featureID}}.uses.bonus">
				<span class="obsidian-binary-operator">&plus;</span>
				<select name="flags.obsidian.features.custom.{{featureID}}.uses.key"
				        data-selector="uses-key">
					{{#select feature.uses.key}}
						<option value="">&mdash;</option>
						{{#each ObsidianRules.FEAT_USES_KEYS}}
							<option value="{{this}}">{{localize (expr '+' 'OBSIDIAN.UsesKey-' this)}}</option>
						{{/each}}
					{{/select}}
				</select>
				<select name="flags.obsidian.features.custom.{{featureID}}.uses.ability" data-show="abl"
				        data-selector-parent="uses-key">
					{{#select feature.uses.ability}}
						{{#each data.abilities}}
							<option value="{{@key}}">{{localize (expr '+' 'OBSIDIAN.Ability-' @key)}}</option>
						{{/each}}
					{{/select}}
				</select>
				<select name="flags.obsidian.features.custom.{{featureID}}.uses.class" data-show="cls"
				        data-selector-parent="uses-key">
					{{#select feature.uses.class}}
						{{#each entity.flags.obsidian.classes as |class id|}}
							<option value="{{id}}">{{class.label}}</option>
						{{/each}}
					{{/select}}
				</select>
			</div>
		</div>
		<div class="obsidian-form-row obsidian-mixed-form-row obsidian-stacked-row">
			<div class="obsidian-checkbox-row">
				<select name="flags.obsidian.features.custom.{{featureID}}.uses.recharge">
					{{#select feature.uses.recharge}}
						<option value="short">{{localize 'OBSIDIAN.ShortRest'}}</option>
						<option value="long">{{localize 'OBSIDIAN.LongRest'}}</option>
					{{/select}}
				</select>
				<div class="obsidian-flex">
					<label class="obsidian-inline">
						<input type="text" name="flags.obsidian.features.custom.{{featureID}}.uses.min"
						       class="obsidian-input-compact obsidian-input-num obsidian-input-num-sm"
						       placeholder="0" data-dtype="Number" value="{{feature.uses.min}}">
						<span>{{localize 'OBSIDIAN.Minimum'}}</span>
					</label>
					<label class="obsidian-inline">
						<input type="text" name="flags.obsidian.features.custom.{{featureID}}.uses.fixed"
						       class="obsidian-input-compact obsidian-input-num obsidian-input-num-sm"
						       value="{{feature.uses.fixed}}">
						<span>{{localize 'OBSIDIAN.Fixed'}}</span>
					</label>
				</div>
			</div>
		</div>
	</fieldset>
	<fieldset {{disabled (expr '!' feature.dc.enabled)}}>
		<legend>
			<div class="fancy-checkbox"
			     data-bound="flags.obsidian.features.custom.{{featureID}}.dc.enabled">
				<div class="checkbox-container">
					<div class="checkbox-inner-box"></div>
					<div class="checkmark-container">
						<div class="checkmark">
							<div class="checkmark-short"></div>
							<div class="checkmark-long"></div>
						</div>
					</div>
				</div>
				<div class="checkbox-content">{{localize 'OBSIDIAN.DC'}}</div>
			</div>
			<input type="checkbox" name="flags.obsidian.features.custom.{{featureID}}.dc.enabled"
			       class="obsidian-hidden" {{checked feature.dc.enabled}}>
		</legend>
		<div class="obsidian-form-row obsidian-mixed-form-row obsidian-inline">
			<input type="text" name="flags.obsidian.features.custom.{{featureID}}.dc.bonus"
			       placeholder="8" value="{{feature.dc.bonus}}"
			       class="obsidian-input-compact obsidian-input-num obsidian-input-num-sm">
			<span class="obsidian-binary-operator">&plus;</span>
			<select name="flags.obsidian.features.custom.{{featureID}}.dc.prof" data-dtype="Number">
				{{#select feature.dc.prof}}
					<option value="">&mdash;</option>
					{{#each ObsidianRules.PLUS_PROF}}
						<option value="{{@key}}">{{localize (expr '+' 'OBSIDIAN.PlusProf-' this)}}</option>
					{{/each}}
				{{/select}}
			</select>
			<span class="obsidian-binary-operator">&plus;</span>
			<select name="flags.obsidian.features.custom.{{featureID}}.dc.ability">
				{{#select feature.dc.ability}}
					<option value="">&mdash;</option>
					{{#each data.abilities}}
						<option value="{{@key}}">{{localize (expr '+' 'OBSIDIAN.Ability-' @key)}}</option>
					{{/each}}
				{{/select}}
			</select>
		</div>
		<div class="obsidian-form-row obsidian-stacked-row">
			<label class="obsidian-inline">
				<input type="text" name="flags.obsidian.features.custom.{{featureID}}.dc.fixed"
				       class="obsidian-input-compact obsidian-input-num obsidian-input-num-sm"
				       value="{{feature.dc.fixed}}">
				<span>{{localize 'OBSIDIAN.Fixed'}}</span>
			</label>
		</div>
	</fieldset>
	<label class="obsidian-label-lg">{{localize 'OBSIDIAN.Description'}}</label>
	<div class="obsidian-rich-text">
		{{editor content=feature.desc button=false editable=editable
		         target=(expr '+' 'flags.obsidian.features.custom.' featureID '.desc')}}
	</div>
</form>
